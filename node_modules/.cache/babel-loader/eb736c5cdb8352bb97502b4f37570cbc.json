{"ast":null,"code":"'use strict';\n\nvar mimicFn = require('mimic-fn');\n\nmodule.exports = function (fn, opts) {\n  // TODO: Remove this in v3\n  if (opts === true) {\n    throw new TypeError('The second argument is now an options object');\n  }\n\n  if (typeof fn !== 'function') {\n    throw new TypeError('Expected a function');\n  }\n\n  opts = opts || {};\n  var ret;\n  var called = false;\n  var fnName = fn.displayName || fn.name || '<anonymous>';\n\n  var onetime = function onetime() {\n    if (called) {\n      if (opts.throw === true) {\n        throw new Error(\"Function `\".concat(fnName, \"` can only be called once\"));\n      }\n\n      return ret;\n    }\n\n    called = true;\n    ret = fn.apply(this, arguments);\n    fn = null;\n    return ret;\n  };\n\n  mimicFn(onetime, fn);\n  return onetime;\n};","map":null,"metadata":{},"sourceType":"script"}