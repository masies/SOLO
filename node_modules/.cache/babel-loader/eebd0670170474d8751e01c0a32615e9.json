{"ast":null,"code":"import _defineProperty from \"/Users/MS/Desktop/Projects/SOLO/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"/Users/MS/Desktop/Projects/SOLO/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/MS/Desktop/Projects/SOLO/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/MS/Desktop/Projects/SOLO/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/MS/Desktop/Projects/SOLO/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/MS/Desktop/Projects/SOLO/node_modules/@babel/runtime/helpers/esm/inherits\";\n// See https://github.com/danigb/soundfont-player\n// for more documentation on prop options.\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport Soundfont from 'soundfont-player';\n\nvar SoundfontProvider =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(SoundfontProvider, _React$Component);\n\n  function SoundfontProvider(props) {\n    var _this;\n\n    _classCallCheck(this, SoundfontProvider);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(SoundfontProvider).call(this, props));\n\n    _this.loadInstrument = function (instrumentName) {\n      // Re-trigger loading state\n      var loader = {\n        border: '16px solid #f3f3f3',\n\n        /* Light grey */\n        borderTop: '16px solid #3498db',\n\n        /* Blue */\n        borderRadius: '50%',\n        width: '120px',\n        height: '120px',\n        animation: 'spin 2s linear infinite',\n        color: '#F5AE20'\n      };\n      console.log('carico');\n      var title = document.createElement('div');\n      title.style = loader;\n      title.appendChild(document.createTextNode(\"The big title!\")); //title.style.color = \"#F5AE20\";\n      //title.style.textAlign = \"center\"; //this is what I'm trying to solve my problem\n\n      document.body.appendChild(title);\n      Soundfont.instrument(_this.props.audioContext, instrumentName, {\n        format: _this.props.format,\n        soundfont: _this.props.soundfont,\n        nameToUrl: function nameToUrl(name, soundfont, format) {\n          return \"\".concat(_this.props.hostname, \"/\").concat(soundfont, \"/\").concat(name, \"-\").concat(format, \".js\");\n        }\n      }).then(function (instrument) {\n        console.log('fatto');\n\n        _this.setState({\n          instrument: instrument\n        });\n      });\n    };\n\n    _this.playNote = function (midiNumber) {\n      _this.resumeAudio().then(function () {\n        var audioNode = _this.state.instrument.play(midiNumber);\n\n        _this.setState({\n          activeAudioNodes: Object.assign({}, _this.state.activeAudioNodes, _defineProperty({}, midiNumber, audioNode))\n        });\n      });\n    };\n\n    _this.stopNote = function (midiNumber) {\n      _this.resumeAudio().then(function () {\n        if (!_this.state.activeAudioNodes[midiNumber]) {\n          return;\n        }\n\n        var audioNode = _this.state.activeAudioNodes[midiNumber];\n        audioNode.stop();\n\n        _this.setState({\n          activeAudioNodes: Object.assign({}, _this.state.activeAudioNodes, _defineProperty({}, midiNumber, null))\n        });\n      });\n    };\n\n    _this.resumeAudio = function () {\n      if (_this.props.audioContext.state === 'suspended') {\n        return _this.props.audioContext.resume();\n      } else {\n        return Promise.resolve();\n      }\n    };\n\n    _this.stopAllNotes = function () {\n      _this.props.audioContext.resume().then(function () {\n        var activeAudioNodes = Object.values(_this.state.activeAudioNodes);\n        activeAudioNodes.forEach(function (node) {\n          if (node) {\n            node.stop();\n          }\n        });\n\n        _this.setState({\n          activeAudioNodes: {}\n        });\n      });\n    };\n\n    _this.state = {\n      activeAudioNodes: {},\n      instrument: null\n    };\n    return _this;\n  }\n\n  _createClass(SoundfontProvider, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.loadInstrument(this.props.instrumentName);\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps, prevState) {\n      if (prevProps.instrumentName !== this.props.instrumentName) {\n        this.loadInstrument(this.props.instrumentName);\n      }\n\n      if (prevState.instrument !== this.state.instrument) {\n        if (!this.props.onLoad) {\n          return;\n        }\n\n        this.props.onLoad({\n          playNote: this.playNote,\n          stopNote: this.stopNote,\n          stopAllNotes: this.stopAllNotes\n        });\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return this.props.render ? this.props.render({\n        isLoading: !this.state.instrument,\n        playNote: this.playNote,\n        stopNote: this.stopNote,\n        stopAllNotes: this.stopAllNotes\n      }) : null;\n    }\n  }]);\n\n  return SoundfontProvider;\n}(React.Component);\n\nSoundfontProvider.propTypes = {\n  instrumentName: PropTypes.string.isRequired,\n  hostname: PropTypes.string.isRequired,\n  format: PropTypes.oneOf(['mp3', 'ogg']),\n  soundfont: PropTypes.oneOf(['MusyngKite', 'FluidR3_GM']),\n  audioContext: PropTypes.instanceOf(window.AudioContext),\n  onLoad: PropTypes.func,\n  render: PropTypes.func\n};\nSoundfontProvider.defaultProps = {\n  format: 'mp3',\n  soundfont: 'MusyngKite' // instrumentName: 'viola',\n\n};\nexport default SoundfontProvider;","map":{"version":3,"sources":["/Users/MS/Desktop/Projects/SOLO/src/components/keyboard/SoundfontProvider.js"],"names":["React","PropTypes","Soundfont","SoundfontProvider","props","loadInstrument","instrumentName","loader","border","borderTop","borderRadius","width","height","animation","color","console","log","title","document","createElement","style","appendChild","createTextNode","body","instrument","audioContext","format","soundfont","nameToUrl","name","hostname","then","setState","playNote","midiNumber","resumeAudio","audioNode","state","play","activeAudioNodes","Object","assign","stopNote","stop","resume","Promise","resolve","stopAllNotes","values","forEach","node","prevProps","prevState","onLoad","render","isLoading","Component","propTypes","string","isRequired","oneOf","instanceOf","window","AudioContext","func","defaultProps"],"mappings":"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","sourcesContent":["// See https://github.com/danigb/soundfont-player\n// for more documentation on prop options.\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport Soundfont from 'soundfont-player';\n\nclass SoundfontProvider extends React.Component {\n  static propTypes = {\n    instrumentName: PropTypes.string.isRequired,\n    hostname: PropTypes.string.isRequired,\n    format: PropTypes.oneOf(['mp3', 'ogg']),\n    soundfont: PropTypes.oneOf(['MusyngKite', 'FluidR3_GM']),\n    audioContext: PropTypes.instanceOf(window.AudioContext),\n    onLoad: PropTypes.func,\n    render: PropTypes.func,\n  };\n\n  static defaultProps = {\n    format: 'mp3',\n    soundfont: 'MusyngKite',\n    // instrumentName: 'viola',\n  };\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      activeAudioNodes: {},\n      instrument: null,\n    };\n  }\n\n  componentDidMount() {\n    this.loadInstrument(this.props.instrumentName);\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if (prevProps.instrumentName !== this.props.instrumentName) {\n      this.loadInstrument(this.props.instrumentName);\n    }\n\n    if (prevState.instrument !== this.state.instrument) {\n      if (!this.props.onLoad) {\n        return;\n      }\n      this.props.onLoad({\n        playNote: this.playNote,\n        stopNote: this.stopNote,\n        stopAllNotes: this.stopAllNotes,\n      });\n    }\n  }\n\n\n\n\n\n  loadInstrument = (instrumentName) => {\n    // Re-trigger loading state\n    let loader = {\n      border: '16px solid #f3f3f3', /* Light grey */\n      borderTop: '16px solid #3498db', /* Blue */\n      borderRadius: '50%',\n      width: '120px',\n      height: '120px',\n      animation: 'spin 2s linear infinite',\n      color:'#F5AE20'\n    }\n    console.log('carico')\n    let title = document.createElement('div');\n    title.style = loader\n    title.appendChild(document.createTextNode(\"The big title!\"));\n    //title.style.color = \"#F5AE20\";\n    //title.style.textAlign = \"center\"; //this is what I'm trying to solve my problem\n    \n    document.body.appendChild(title); \n\n    Soundfont.instrument(this.props.audioContext, instrumentName, {\n      format: this.props.format,\n      soundfont: this.props.soundfont,\n      nameToUrl: (name, soundfont, format) => {\n        return `${this.props.hostname}/${soundfont}/${name}-${format}.js`;\n      },\n    }).then((instrument) => {\n      console.log('fatto')\n      this.setState({\n        instrument,\n      });\n    });\n  };\n\n  playNote = (midiNumber) => {\n    this.resumeAudio().then(() => {\n      const audioNode = this.state.instrument.play(midiNumber);\n      this.setState({\n        activeAudioNodes: Object.assign({}, this.state.activeAudioNodes, {\n          [midiNumber]: audioNode,\n        }),\n      });\n    });\n  };\n\n  stopNote = (midiNumber) => {\n    this.resumeAudio().then(() => {\n      if (!this.state.activeAudioNodes[midiNumber]) {\n        return;\n      }\n      const audioNode = this.state.activeAudioNodes[midiNumber];\n      audioNode.stop();\n      this.setState({\n        activeAudioNodes: Object.assign({}, this.state.activeAudioNodes, { [midiNumber]: null }),\n      });\n    });\n  };\n\n  resumeAudio = () => {\n    if (this.props.audioContext.state === 'suspended') {\n      return this.props.audioContext.resume();\n    } else {\n      return Promise.resolve();\n    }\n  };\n\n  // Clear any residual notes that don't get called with stopNote\n  stopAllNotes = () => {\n    this.props.audioContext.resume().then(() => {\n      const activeAudioNodes = Object.values(this.state.activeAudioNodes);\n      activeAudioNodes.forEach((node) => {\n        if (node) {\n          node.stop();\n        }\n      });\n      this.setState({\n        activeAudioNodes: {},\n      });\n    });\n  };\n\n  render() {\n    return this.props.render\n    ? this.props.render({\n      isLoading: !this.state.instrument,\n      playNote: this.playNote,\n      stopNote: this.stopNote,\n      stopAllNotes: this.stopAllNotes,\n    })\n    : null;\n  }\n}\n\nexport default SoundfontProvider;\n"]},"metadata":{},"sourceType":"module"}